<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de Usuario</title>
    <link rel="stylesheet" href="../../css/perfil.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <div class="container">
        <header class="main-header">
            <nav class="navbar">
                <a href="/index.html" class="logo">Mercachula</a>
                <ul class="nav-links">
                    <li><a href="/index.html">Inicio</a></li>
                    <li><a href="/pages/perfil/perfil.html">Perfil</a></li>
                    <li><a href="/pages/listadecomercios/listahoteles.html">Hoteles</a></li>
                    
                </ul>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </header>

        <div class="profile">
            <aside class="profile-sidebar">
                <ul>
                    <li><a href="./perfil.html">Datos Personales</a></li>
                    
                </ul>
            </aside>

            <main class="profile-main">
                <form method="post" id="updateForm">
                    <section id="datos-personales" class="profile-section">
                        <h2>Datos Personales</h2>
                        <div class="profile-info">
                            <label for="id">ID:</label>
                            <input type="text" id="id" readonly>
                        </div>
                        <div class="profile-info">
                            <label for="nombre">Nombre:</label>
                            <input type="text" id="nombre">
                        </div>
                        <div class="profile-info">
                            <label for="apellido">Apellido:</label>
                            <input type="text" id="apellido">
                        </div>
                        <div class="profile-info">
                            <label for="celular">NÃºmero de Celular:</label>
                            <input type="text" id="celular">
                        </div>
                        <button type="submit" class="btn">Editar</button>
                        <button type="submit" id="closeSession" class="btn2">Cerrar Sesion</button>
                    </section>
                </form>

                <section id="mis-hoteles" class="profile-section">
                    <h2>Mis Hoteles</h2>
                    <button class="botonperfil"><a href="/pages/hoteles/lista_hoteles.html">Entrar</a></button>
                    
                </section>

                <section id="mis-restaurantes" class="profile-section">
                    <h2>Mis Restaurantes</h2>
                    <button class="botonperfil"><a href="/pages/hoteles/resta.html">Entrar</a></button>
                    
                </section>
            </main>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            axios.get(`https://mercachula-api.vercel.app/users?token=${localStorage.getItem("token")}`, {
                responseType: "json"
            })
            .then((userData) => {
                document.getElementById("id").value = userData.data["_id"];
                document.getElementById("nombre").value = userData.data["Nombres"];
                document.getElementById("apellido").value = userData.data["Apellidos"];
                document.getElementById("celular").value = userData.data["NumeroCelular"];
                // Load user's hotels and restaurants
                loadUserHotels(userData.data["_id"]);
                loadUserRestaurants(userData.data["_id"]);
            });

            document.getElementById("updateForm").addEventListener("submit" , (evt) => {
                evt.preventDefault();
                const nombre = document.getElementById("nombre").value;
                const apellido = document.getElementById("apellido").value;
                const celular = document.getElementById("celular").value;
                axios.put(`https://mercachula-api.vercel.app/users?token=${localStorage.getItem("token")}`, {
                    Nombres: nombre,
                    Apellidos: apellido,
                    NumeroCelular: celular
                })
                .then(() => {
                    location.reload();
                })
            });

            document.getElementById("closeSession").addEventListener("click", () => {
                localStorage.removeItem("token");
                window.location.href = '../../index.html';
            });
        });

        // Responsive navbar script
        document.querySelector('.hamburger').addEventListener('click', () => {
            document.querySelector('.nav-links').classList.toggle('nav-active');
        });
    </script>
</body>

</html>



